<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MiMiCheck Profil - Optimiert</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Inter', sans-serif; }
    h1, h2, h3, .brand { font-family: 'Space Grotesk', sans-serif; }
    
    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
    ::-webkit-scrollbar-thumb { background: rgba(6,182,212,0.3); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(6,182,212,0.5); }
    
    /* Smooth transitions */
    .nav-item { transition: all 0.2s ease; }
    .nav-item:hover { transform: translateX(4px); }
    .nav-item.active { background: linear-gradient(90deg, rgba(6,182,212,0.15), rgba(20,184,166,0.1)); }
    
    /* Content fade in */
    .content-section { animation: fadeIn 0.3s ease; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Input focus glow */
    input:focus, select:focus {
      box-shadow: 0 0 0 3px rgba(6,182,212,0.15);
    }
    
    /* Progress bar shimmer */
    .progress-bar {
      background: linear-gradient(90deg, #06b6d4, #14b8a6, #10b981);
      background-size: 200% 100%;
      animation: shimmer 2s ease infinite;
    }
    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    /* Save button pulse */
    .save-btn:not(:disabled):hover {
      box-shadow: 0 0 30px rgba(6,182,212,0.4);
    }
    
    /* Hide scrollbar but keep functionality */
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
  </style>
</head>
<body class="bg-slate-950 text-white min-h-screen">
  
  <div id="app" class="flex h-screen overflow-hidden">
    
    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <!-- SIDEBAR - Fixed Left Navigation -->
    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <aside id="sidebar" class="w-72 bg-slate-900/95 backdrop-blur-xl border-r border-white/10 flex flex-col h-full shrink-0">
      
      <!-- Logo -->
      <div class="p-6 border-b border-white/10">
        <h1 class="brand text-2xl font-bold bg-gradient-to-r from-cyan-400 via-teal-400 to-emerald-400 bg-clip-text text-transparent">
          MiMiCheck
        </h1>
        <p class="text-xs text-white/50 mt-1">Dein digitaler Antragshelfer</p>
      </div>
      
      <!-- Progress -->
      <div class="px-6 py-4 border-b border-white/10">
        <div class="flex items-center justify-between mb-2">
          <span class="text-xs text-white/50">Profil-Vollständigkeit</span>
          <span id="progress-text" class="text-sm font-bold text-cyan-400">0%</span>
        </div>
        <div class="h-2 bg-white/10 rounded-full overflow-hidden">
          <div id="progress-bar" class="progress-bar h-full rounded-full transition-all duration-700" style="width: 0%"></div>
        </div>
      </div>
      
      <!-- Navigation -->
      <nav class="flex-1 overflow-y-auto py-4 px-3 hide-scrollbar">
        <div id="nav-items" class="space-y-1"></div>
      </nav>
      
      <!-- Compliance Footer -->
      <div class="p-4 border-t border-white/10">
        <div class="flex flex-wrap gap-2 text-[10px] text-white/40">
          <span class="flex items-center gap-1 px-2 py-1 rounded bg-white/5">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
            DSGVO
          </span>
          <span class="flex items-center gap-1 px-2 py-1 rounded bg-white/5">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
            AES-256
          </span>
          <span class="flex items-center gap-1 px-2 py-1 rounded bg-white/5">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg>
            EU AI Act
          </span>
        </div>
      </div>
    </aside>
    
    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <!-- MAIN CONTENT AREA -->
    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <main class="flex-1 flex flex-col h-full overflow-hidden">
      
      <!-- Header -->
      <header class="shrink-0 bg-slate-950/90 backdrop-blur-xl border-b border-white/10 px-8 py-5">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <div id="header-icon" class="w-12 h-12 rounded-xl bg-gradient-to-r from-cyan-500 to-teal-500 flex items-center justify-center">
              <!-- Icon injected by JS -->
            </div>
            <div>
              <h2 id="header-title" class="text-xl font-semibold text-white">Persönliche Daten</h2>
              <p id="header-subtitle" class="text-sm text-white/50">Ihre grundlegenden Informationen</p>
            </div>
          </div>
          
          <!-- Save Button -->
          <button id="save-btn" onclick="handleSave()" disabled
            class="save-btn px-6 py-3 rounded-xl font-semibold flex items-center gap-2 transition-all
                   bg-gradient-to-r from-cyan-500 to-teal-500 disabled:opacity-40 disabled:cursor-not-allowed">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
            <span id="save-text">Speichern</span>
          </button>
        </div>
      </header>
      
      <!-- Content - Always starts at top! -->
      <div id="content-container" class="flex-1 overflow-y-auto">
        <div id="content" class="max-w-4xl mx-auto px-8 py-8">
          <!-- Content injected by JS -->
        </div>
        
        <!-- DSGVO Warning Banner -->
        <div id="dsgvo-warning" class="hidden max-w-4xl mx-auto px-8 pb-8">
          <div class="p-4 rounded-xl bg-amber-500/10 border border-amber-500/30 flex items-center gap-4">
            <svg class="w-6 h-6 text-amber-400 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
            <p class="text-sm text-amber-200">
              <strong>Hinweis:</strong> Bitte stimmen Sie im Bereich "Datenschutz" der Datenverarbeitung zu, um Ihr Profil speichern zu können.
            </p>
            <button onclick="navigateTo('einwilligungen')" class="ml-auto px-4 py-2 rounded-lg bg-amber-500/20 text-amber-200 text-sm hover:bg-amber-500/30 transition-all whitespace-nowrap">
              Zu Datenschutz →
            </button>
          </div>
        </div>
      </div>
      
      <!-- Footer -->
      <footer class="shrink-0 border-t border-white/10 px-8 py-3">
        <div class="flex items-center justify-between text-xs text-white/30">
          <span>© 2025 MiMiCheck - Alle Rechte vorbehalten</span>
          <span>Made with ❤️ in Deutschland</span>
        </div>
      </footer>
    </main>
  </div>

  <script>
    // ═══════════════════════════════════════════════════════════════════════════
    // MIMICHECK PROFIL - JAVASCRIPT
    // ═══════════════════════════════════════════════════════════════════════════
    
    // State
    let activeSection = 'persoenlich';
    let profil = {
      persoenlich: { anrede: '', titel: '', vorname: '', nachname: '', geburtsname: '', geburtsdatum: '', geburtsort: '', geschlecht: '', familienstand: '', staatsangehoerigkeit: '', steuer_id: '', sozialversicherungsnummer: '', ausweis_art: '', ausweis_nummer: '', ausweis_gueltig_bis: '' },
      kontakt: { strasse: '', hausnummer: '', adresszusatz: '', plz: '', ort: '', bundesland: '', telefon_mobil: '', telefon_festnetz: '', email: '' },
      bank: { kontoinhaber: '', iban: '', bic: '', bankname: '' },
      krankenversicherung: { versicherungsart: '', krankenkasse_name: '', versichertennummer: '', versicherungsstatus: '', beitragssatz: '' },
      wohnung: { wohnverhaeltnis: '', einzugsdatum: '', kaltmiete: '', nebenkosten: '', heizkosten: '', warmmiete_gesamt: '', wohnflaeche_qm: '', anzahl_zimmer: '', anzahl_personen_haushalt: '', vermieter_name: '', vermieter_strasse: '', vermieter_plz: '', vermieter_ort: '' },
      einkommen: { beschaeftigungsart: '', arbeitgeber_name: '', beschaeftigt_seit: '', bruttoeinkommen_monatlich: '', nettoeinkommen_monatlich: '', steuerklasse: '', arbeitszeit_wochenstunden: '', kindergeld_gesamt: '', elterngeld: '', unterhalt_erhalten: '', arbeitslosengeld_1: '', rente_betrag: '' },
      partner: { hat_partner: false, beziehungsart: '', partner_vorname: '', partner_nachname: '', partner_geburtsdatum: '', partner_steuer_id: '', partner_brutto: '', partner_netto: '' },
      kinder: [],
      vermoegen: { bargeld: '', girokonto_guthaben: '', sparkonto_guthaben: '', aktien_wert: '', lebensversicherung_rueckkaufwert: '', fahrzeug_1_typ: '', fahrzeug_1_wert: '', schulden_gesamt: '' },
      besonderes: { schwerbehindert: false, grad_behinderung: '', pflegegrad: '', alleinerziehend: false, schwangerschaft: false, schwangerschaft_et: '' },
      bildung: { hoechster_schulabschluss: '', berufsausbildung: '', studium: '', fuehrerschein_klassen: '', sprachkenntnisse: '' },
      einwilligungen: { dsgvo_einwilligung: false, ki_verarbeitung_einwilligung: false, datenweitergabe_behoerden: false }
    };
    
    // Section Definitions
    const sections = [
      { id: 'persoenlich', label: 'Persönliche Daten', subtitle: 'Ihre grundlegenden Informationen', icon: 'user', color: 'cyan' },
      { id: 'kontakt', label: 'Kontakt & Adresse', subtitle: 'Wo Sie erreichbar sind', icon: 'map-pin', color: 'teal' },
      { id: 'bank', label: 'Bankverbindung', subtitle: 'Für Auszahlungen', icon: 'credit-card', color: 'emerald' },
      { id: 'krankenversicherung', label: 'Krankenversicherung', subtitle: 'Ihre Versicherungsdaten', icon: 'heart', color: 'rose' },
      { id: 'wohnung', label: 'Wohnsituation', subtitle: 'Miete, Nebenkosten & Vermieter', icon: 'home', color: 'amber' },
      { id: 'einkommen', label: 'Einkommen', subtitle: 'Gehalt & Sozialleistungen', icon: 'briefcase', color: 'blue' },
      { id: 'partner', label: 'Partner/in', subtitle: 'Bedarfsgemeinschaft', icon: 'users', color: 'purple' },
      { id: 'kinder', label: 'Kinder', subtitle: 'Für Kindergeld & Kinderzuschlag', icon: 'baby', color: 'pink' },
      { id: 'vermoegen', label: 'Vermögen', subtitle: 'Ersparnisse & Schulden', icon: 'piggy-bank', color: 'yellow' },
      { id: 'besonderes', label: 'Besondere Umstände', subtitle: 'Mehrbedarf & Sonderfälle', icon: 'alert-circle', color: 'orange' },
      { id: 'bildung', label: 'Bildung', subtitle: 'Abschlüsse & Qualifikationen', icon: 'graduation-cap', color: 'indigo' },
      { id: 'einwilligungen', label: 'Datenschutz', subtitle: 'DSGVO & Einwilligungen', icon: 'shield', color: 'slate' }
    ];
    
    // Icons SVG
    const icons = {
      'user': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>',
      'map-pin': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>',
      'credit-card': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>',
      'heart': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>',
      'home': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>',
      'briefcase': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>',
      'users': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>',
      'baby': '<circle cx="12" cy="8" r="4" stroke-width="2"></circle><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 12c-4 0-6 3-6 6v2h12v-2c0-3-2-6-6-6z"></path>',
      'piggy-bank': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path>',
      'alert-circle': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>',
      'graduation-cap': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path>',
      'shield': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>',
      'hash': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path>',
      'file-text': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>',
      'building': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>',
      'wallet': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>',
      'info': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>',
      'check': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>',
      'chevron-right': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>',
      'plus': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>',
      'trash': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>'
    };
    
    function getIcon(name, size = 20) {
      return `<svg class="w-${size/4} h-${size/4}" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons[name] || icons['user']}</svg>`;
    }
    
    // ═══════════════════════════════════════════════════════════════════════════
    // NAVIGATION
    // ═══════════════════════════════════════════════════════════════════════════
    
    function renderNav() {
      const nav = document.getElementById('nav-items');
      nav.innerHTML = sections.map(s => `
        <button onclick="navigateTo('${s.id}')" 
          class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left ${activeSection === s.id ? 'active border border-cyan-500/30' : 'hover:bg-white/5'}">
          <div class="w-9 h-9 rounded-lg flex items-center justify-center ${activeSection === s.id ? `bg-${s.color}-500` : 'bg-white/10'}">
            <svg class="w-5 h-5 ${activeSection === s.id ? 'text-white' : 'text-white/60'}" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons[s.icon]}</svg>
          </div>
          <span class="text-sm ${activeSection === s.id ? 'text-white font-medium' : 'text-white/70'}">${s.label}</span>
          ${activeSection === s.id ? `<svg class="w-4 h-4 ml-auto text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['chevron-right']}</svg>` : ''}
        </button>
      `).join('');
    }
    
    function navigateTo(sectionId) {
      activeSection = sectionId;
      renderNav();
      renderContent();
      updateHeader();
      
      // WICHTIG: Content Container nach oben scrollen!
      document.getElementById('content-container').scrollTop = 0;
    }
    
    function updateHeader() {
      const section = sections.find(s => s.id === activeSection);
      document.getElementById('header-title').textContent = section.label;
      document.getElementById('header-subtitle').textContent = section.subtitle;
      document.getElementById('header-icon').innerHTML = `<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons[section.icon]}</svg>`;
    }
    
    // ═══════════════════════════════════════════════════════════════════════════
    // FORM HELPERS
    // ═══════════════════════════════════════════════════════════════════════════
    
    function inputField(section, field, label, type = 'text', options = {}) {
      const value = profil[section][field] || '';
      const required = options.required ? '<span class="text-rose-400">*</span>' : '';
      const helper = options.helper ? `<p class="text-xs text-white/40 mt-1">${options.helper}</p>` : '';
      const placeholder = options.placeholder || '';
      const colSpan = options.colSpan ? `col-span-${options.colSpan}` : '';
      
      return `
        <div class="${colSpan}">
          <label class="block text-xs font-medium text-cyan-300/80 mb-1.5">${label} ${required}</label>
          <input type="${type}" value="${value}" placeholder="${placeholder}"
            onchange="updateField('${section}', '${field}', this.value)"
            class="w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 text-sm
                   focus:outline-none focus:border-cyan-500/50 focus:bg-white/10 transition-all">
          ${helper}
        </div>
      `;
    }
    
    function selectField(section, field, label, selectOptions, options = {}) {
      const value = profil[section][field] || '';
      const required = options.required ? '<span class="text-rose-400">*</span>' : '';
      
      const optionsHtml = selectOptions.map(o => 
        `<option value="${o.value}" ${value === o.value ? 'selected' : ''} class="bg-slate-900">${o.label}</option>`
      ).join('');
      
      return `
        <div>
          <label class="block text-xs font-medium text-cyan-300/80 mb-1.5">${label} ${required}</label>
          <select onchange="updateField('${section}', '${field}', this.value)"
            class="w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm appearance-none cursor-pointer
                   focus:outline-none focus:border-cyan-500/50 transition-all">
            <option value="" class="bg-slate-900">Bitte wählen...</option>
            ${optionsHtml}
          </select>
        </div>
      `;
    }
    
    function checkboxField(section, field, label, options = {}) {
      const checked = profil[section][field];
      const helper = options.helper ? `<p class="text-xs text-white/40 mt-0.5">${options.helper}</p>` : '';
      
      return `
        <label class="flex items-start gap-3 cursor-pointer group">
          <div onclick="toggleCheckbox('${section}', '${field}')" 
            class="w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all mt-0.5 cursor-pointer
                   ${checked ? 'bg-gradient-to-r from-cyan-500 to-teal-500 border-transparent' : 'border-white/20 hover:border-white/40'}">
            ${checked ? `<svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['check']}</svg>` : ''}
          </div>
          <div>
            <span class="text-sm text-white/90">${label}</span>
            ${helper}
          </div>
        </label>
      `;
    }
    
    function updateField(section, field, value) {
      profil[section][field] = value;
      updateProgress();
      updateSaveButton();
    }
    
    function toggleCheckbox(section, field) {
      profil[section][field] = !profil[section][field];
      renderContent();
      updateProgress();
      updateSaveButton();
    }
    
    // ═══════════════════════════════════════════════════════════════════════════
    // CONTENT RENDERER
    // ═══════════════════════════════════════════════════════════════════════════
    
    function renderContent() {
      const content = document.getElementById('content');
      content.innerHTML = `<div class="content-section">${getSectionContent()}</div>`;
      
      // DSGVO Warning anzeigen/verstecken
      const warning = document.getElementById('dsgvo-warning');
      if (!profil.einwilligungen.dsgvo_einwilligung && activeSection !== 'einwilligungen') {
        warning.classList.remove('hidden');
      } else {
        warning.classList.add('hidden');
      }
    }
    
    function getSectionContent() {
      switch(activeSection) {
        case 'persoenlich':
          return `
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
              ${selectField('persoenlich', 'anrede', 'Anrede', [
                {value: 'herr', label: 'Herr'}, {value: 'frau', label: 'Frau'}, {value: 'divers', label: 'Divers'}
              ])}
              ${inputField('persoenlich', 'titel', 'Titel', 'text', {placeholder: 'z.B. Dr., Prof.'})}
              ${inputField('persoenlich', 'vorname', 'Vorname', 'text', {required: true})}
              ${inputField('persoenlich', 'nachname', 'Nachname', 'text', {required: true})}
              ${inputField('persoenlich', 'geburtsname', 'Geburtsname', 'text', {placeholder: 'Falls abweichend'})}
              ${inputField('persoenlich', 'geburtsdatum', 'Geburtsdatum', 'date', {required: true})}
              ${inputField('persoenlich', 'geburtsort', 'Geburtsort', 'text')}
              ${selectField('persoenlich', 'geschlecht', 'Geschlecht', [
                {value: 'm', label: 'Männlich'}, {value: 'w', label: 'Weiblich'}, {value: 'd', label: 'Divers'}
              ])}
              ${selectField('persoenlich', 'familienstand', 'Familienstand', [
                {value: 'ledig', label: 'Ledig'}, {value: 'verheiratet', label: 'Verheiratet'},
                {value: 'geschieden', label: 'Geschieden'}, {value: 'verwitwet', label: 'Verwitwet'}
              ], {required: true})}
              ${inputField('persoenlich', 'staatsangehoerigkeit', 'Staatsangehörigkeit', 'text', {placeholder: 'z.B. deutsch'})}
            </div>
            
            <div class="p-5 rounded-xl bg-cyan-500/10 border border-cyan-500/20 mb-6">
              <h4 class="text-sm font-semibold text-cyan-300 mb-4 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['hash']}</svg>
                Identifikationsnummern (wichtig für Anträge!)
              </h4>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                ${inputField('persoenlich', 'steuer_id', 'Steuer-Identifikationsnummer', 'text', {required: true, placeholder: '11-stellig', helper: 'Pflicht für Kindergeld seit 2016'})}
                ${inputField('persoenlich', 'sozialversicherungsnummer', 'Sozialversicherungsnummer', 'text', {placeholder: '12-stellig', helper: 'Für Jobcenter & Krankenkasse'})}
              </div>
            </div>
            
            <div class="p-5 rounded-xl bg-white/5 border border-white/10">
              <h4 class="text-sm font-semibold text-white/80 mb-4 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['file-text']}</svg>
                Ausweisdokument
              </h4>
              <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                ${selectField('persoenlich', 'ausweis_art', 'Ausweisart', [
                  {value: 'perso', label: 'Personalausweis'}, {value: 'pass', label: 'Reisepass'}
                ])}
                ${inputField('persoenlich', 'ausweis_nummer', 'Ausweisnummer', 'text')}
                ${inputField('persoenlich', 'ausweis_gueltig_bis', 'Gültig bis', 'date')}
              </div>
            </div>
          `;
          
        case 'kontakt':
          return `
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
              <div class="sm:col-span-2">${inputField('kontakt', 'strasse', 'Straße', 'text', {required: true})}</div>
              ${inputField('kontakt', 'hausnummer', 'Hausnummer', 'text', {required: true})}
              ${inputField('kontakt', 'adresszusatz', 'Adresszusatz', 'text', {placeholder: 'z.B. 3. OG links'})}
              ${inputField('kontakt', 'plz', 'PLZ', 'text', {required: true})}
              ${inputField('kontakt', 'ort', 'Ort', 'text', {required: true})}
              ${selectField('kontakt', 'bundesland', 'Bundesland', [
                {value: 'bw', label: 'Baden-Württemberg'}, {value: 'by', label: 'Bayern'},
                {value: 'be', label: 'Berlin'}, {value: 'bb', label: 'Brandenburg'},
                {value: 'hb', label: 'Bremen'}, {value: 'hh', label: 'Hamburg'},
                {value: 'he', label: 'Hessen'}, {value: 'mv', label: 'Mecklenburg-Vorpommern'},
                {value: 'ni', label: 'Niedersachsen'}, {value: 'nw', label: 'Nordrhein-Westfalen'},
                {value: 'rp', label: 'Rheinland-Pfalz'}, {value: 'sl', label: 'Saarland'},
                {value: 'sn', label: 'Sachsen'}, {value: 'st', label: 'Sachsen-Anhalt'},
                {value: 'sh', label: 'Schleswig-Holstein'}, {value: 'th', label: 'Thüringen'}
              ])}
              ${inputField('kontakt', 'telefon_mobil', 'Mobiltelefon', 'tel')}
              ${inputField('kontakt', 'telefon_festnetz', 'Festnetz', 'tel')}
              ${inputField('kontakt', 'email', 'E-Mail', 'email')}
            </div>
          `;
          
        case 'bank':
          return `
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              ${inputField('bank', 'kontoinhaber', 'Kontoinhaber', 'text', {required: true})}
              ${inputField('bank', 'iban', 'IBAN', 'text', {required: true, placeholder: 'DE00 0000 0000 0000 0000 00', helper: '22-stellig für deutsche Konten'})}
              ${inputField('bank', 'bic', 'BIC / SWIFT', 'text')}
              ${inputField('bank', 'bankname', 'Bankname', 'text')}
            </div>
            <div class="mt-6 p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/20">
              <p class="text-sm text-emerald-300 flex items-start gap-2">
                <svg class="w-5 h-5 shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['info']}</svg>
                <span>Ihre Bankverbindung wird für die Auszahlung von Kindergeld, Wohngeld und anderen Leistungen benötigt.</span>
              </p>
            </div>
          `;
          
        case 'krankenversicherung':
          return `
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
              ${selectField('krankenversicherung', 'versicherungsart', 'Versicherungsart', [
                {value: 'gesetzlich', label: 'Gesetzlich versichert'},
                {value: 'privat', label: 'Privat versichert'}
              ], {required: true})}
              ${inputField('krankenversicherung', 'krankenkasse_name', 'Name der Krankenkasse', 'text', {required: true, placeholder: 'z.B. AOK, TK, Barmer'})}
              ${inputField('krankenversicherung', 'versichertennummer', 'Versichertennummer', 'text', {helper: 'Steht auf Ihrer Gesundheitskarte'})}
              ${selectField('krankenversicherung', 'versicherungsstatus', 'Versicherungsstatus', [
                {value: 'pflicht', label: 'Pflichtversichert'},
                {value: 'freiwillig', label: 'Freiwillig versichert'},
                {value: 'familie', label: 'Familienversichert'}
              ])}
              ${inputField('krankenversicherung', 'beitragssatz', 'Monatlicher Beitrag (€)', 'number')}
            </div>
          `;
          
        case 'wohnung':
          return `
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
              ${selectField('wohnung', 'wohnverhaeltnis', 'Wohnverhältnis', [
                {value: 'miete', label: 'Zur Miete'}, {value: 'eigentum', label: 'Eigentum'},
                {value: 'untermiete', label: 'Untermiete'}, {value: 'mietfrei', label: 'Mietfrei'}
              ], {required: true})}
              ${inputField('wohnung', 'einzugsdatum', 'Einzugsdatum', 'date')}
              ${inputField('wohnung', 'wohnflaeche_qm', 'Wohnfläche (m²)', 'number')}
              ${inputField('wohnung', 'anzahl_zimmer', 'Anzahl Zimmer', 'number')}
              ${inputField('wohnung', 'anzahl_personen_haushalt', 'Personen im Haushalt', 'number')}
            </div>
            
            <div class="p-5 rounded-xl bg-amber-500/10 border border-amber-500/20 mb-6">
              <h4 class="text-sm font-semibold text-amber-300 mb-4 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['wallet']}</svg>
                Mietkosten (wichtig für Wohngeld & Bürgergeld)
              </h4>
              <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                ${inputField('wohnung', 'kaltmiete', 'Kaltmiete (€)', 'number')}
                ${inputField('wohnung', 'nebenkosten', 'Nebenkosten (€)', 'number')}
                ${inputField('wohnung', 'heizkosten', 'Heizkosten (€)', 'number')}
                ${inputField('wohnung', 'warmmiete_gesamt', 'Warmmiete gesamt (€)', 'number')}
              </div>
            </div>
            
            <div class="p-5 rounded-xl bg-white/5 border border-white/10">
              <h4 class="text-sm font-semibold text-white/80 mb-4 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['building']}</svg>
                Vermieter (für Mietbescheinigung)
              </h4>
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                ${inputField('wohnung', 'vermieter_name', 'Name / Firma', 'text')}
                ${inputField('wohnung', 'vermieter_strasse', 'Straße + Nr.', 'text')}
                ${inputField('wohnung', 'vermieter_plz', 'PLZ', 'text')}
                ${inputField('wohnung', 'vermieter_ort', 'Ort', 'text')}
              </div>
            </div>
          `;
          
        case 'einkommen':
          return `
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
              ${selectField('einkommen', 'beschaeftigungsart', 'Beschäftigungsart', [
                {value: 'vollzeit', label: 'Angestellt (Vollzeit)'}, {value: 'teilzeit', label: 'Angestellt (Teilzeit)'},
                {value: 'minijob', label: 'Minijob (520€)'}, {value: 'selbststaendig', label: 'Selbstständig'},
                {value: 'arbeitslos', label: 'Arbeitslos'}, {value: 'rente', label: 'Rentner/in'},
                {value: 'student', label: 'Student/in'}, {value: 'elternzeit', label: 'Elternzeit'}
              ], {required: true})}
              ${inputField('einkommen', 'arbeitgeber_name', 'Arbeitgeber', 'text')}
              ${inputField('einkommen', 'beschaeftigt_seit', 'Beschäftigt seit', 'date')}
              ${inputField('einkommen', 'bruttoeinkommen_monatlich', 'Bruttoeinkommen (€)', 'number')}
              ${inputField('einkommen', 'nettoeinkommen_monatlich', 'Nettoeinkommen (€)', 'number')}
              ${selectField('einkommen', 'steuerklasse', 'Steuerklasse', [
                {value: '1', label: 'I'}, {value: '2', label: 'II'}, {value: '3', label: 'III'},
                {value: '4', label: 'IV'}, {value: '5', label: 'V'}, {value: '6', label: 'VI'}
              ])}
              ${inputField('einkommen', 'arbeitszeit_wochenstunden', 'Wochenstunden', 'number')}
            </div>
            
            <div class="p-5 rounded-xl bg-blue-500/10 border border-blue-500/20">
              <h4 class="text-sm font-semibold text-blue-300 mb-4 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['piggy-bank']}</svg>
                Weitere Einkünfte & Sozialleistungen
              </h4>
              <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                ${inputField('einkommen', 'kindergeld_gesamt', 'Kindergeld (€)', 'number')}
                ${inputField('einkommen', 'elterngeld', 'Elterngeld (€)', 'number')}
                ${inputField('einkommen', 'unterhalt_erhalten', 'Unterhalt (€)', 'number')}
                ${inputField('einkommen', 'arbeitslosengeld_1', 'ALG I (€)', 'number')}
                ${inputField('einkommen', 'rente_betrag', 'Rente (€)', 'number')}
              </div>
            </div>
          `;
          
        case 'partner':
          return `
            <div class="mb-6">
              ${checkboxField('partner', 'hat_partner', 'Ich habe einen Partner / eine Partnerin im Haushalt', {helper: 'Wichtig für Bedarfsgemeinschaft bei Bürgergeld'})}
            </div>
            
            ${profil.partner.hat_partner ? `
              <div class="p-5 rounded-xl bg-purple-500/10 border border-purple-500/20">
                <h4 class="text-sm font-semibold text-purple-300 mb-4">Partner/in Daten</h4>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                  ${selectField('partner', 'beziehungsart', 'Beziehungsart', [
                    {value: 'ehe', label: 'Ehepartner/in'}, {value: 'lp', label: 'Eingetragene/r Lebenspartner/in'},
                    {value: 'lg', label: 'Lebensgemeinschaft'}
                  ])}
                  ${inputField('partner', 'partner_vorname', 'Vorname', 'text')}
                  ${inputField('partner', 'partner_nachname', 'Nachname', 'text')}
                  ${inputField('partner', 'partner_geburtsdatum', 'Geburtsdatum', 'date')}
                  ${inputField('partner', 'partner_steuer_id', 'Steuer-ID', 'text')}
                  ${inputField('partner', 'partner_brutto', 'Bruttoeinkommen (€)', 'number')}
                  ${inputField('partner', 'partner_netto', 'Nettoeinkommen (€)', 'number')}
                </div>
              </div>
            ` : `
              <div class="p-8 rounded-xl bg-white/5 border border-white/10 text-center">
                <svg class="w-12 h-12 mx-auto text-white/20 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['users']}</svg>
                <p class="text-white/40">Aktivieren Sie die Checkbox oben, um Partner-Daten einzugeben.</p>
              </div>
            `}
          `;
          
        case 'kinder':
          return `
            <div class="space-y-4 mb-6">
              ${profil.kinder.map((kind, index) => `
                <div class="p-5 rounded-xl bg-pink-500/10 border border-pink-500/20">
                  <div class="flex items-center justify-between mb-4">
                    <h4 class="font-semibold text-pink-300 flex items-center gap-2">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['baby']}</svg>
                      Kind ${index + 1}
                    </h4>
                    <button onclick="removeKind(${index})" class="text-rose-400 hover:text-rose-300 text-sm flex items-center gap-1">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['trash']}</svg>
                      Entfernen
                    </button>
                  </div>
                  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                      <label class="block text-xs font-medium text-cyan-300/80 mb-1.5">Vorname</label>
                      <input type="text" value="${kind.vorname}" onchange="updateKind(${index}, 'vorname', this.value)"
                        class="w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm focus:outline-none focus:border-cyan-500/50 transition-all">
                    </div>
                    <div>
                      <label class="block text-xs font-medium text-cyan-300/80 mb-1.5">Nachname</label>
                      <input type="text" value="${kind.nachname}" onchange="updateKind(${index}, 'nachname', this.value)"
                        class="w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm focus:outline-none focus:border-cyan-500/50 transition-all">
                    </div>
                    <div>
                      <label class="block text-xs font-medium text-cyan-300/80 mb-1.5">Geburtsdatum</label>
                      <input type="date" value="${kind.geburtsdatum}" onchange="updateKind(${index}, 'geburtsdatum', this.value)"
                        class="w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm focus:outline-none focus:border-cyan-500/50 transition-all">
                    </div>
                    <div>
                      <label class="block text-xs font-medium text-cyan-300/80 mb-1.5">Steuer-ID <span class="text-rose-400">*</span></label>
                      <input type="text" value="${kind.steuer_id}" onchange="updateKind(${index}, 'steuer_id', this.value)"
                        placeholder="11-stellig"
                        class="w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm focus:outline-none focus:border-cyan-500/50 transition-all">
                      <p class="text-xs text-white/40 mt-1">Pflicht für Kindergeld!</p>
                    </div>
                  </div>
                  <div class="mt-4 flex gap-6">
                    <label class="flex items-center gap-2 cursor-pointer">
                      <div onclick="toggleKindCheckbox(${index}, 'lebt_im_haushalt')" 
                        class="w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all cursor-pointer
                               ${kind.lebt_im_haushalt ? 'bg-gradient-to-r from-cyan-500 to-teal-500 border-transparent' : 'border-white/20'}">
                        ${kind.lebt_im_haushalt ? `<svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['check']}</svg>` : ''}
                      </div>
                      <span class="text-sm text-white/90">Lebt im Haushalt</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer">
                      <div onclick="toggleKindCheckbox(${index}, 'in_ausbildung')" 
                        class="w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all cursor-pointer
                               ${kind.in_ausbildung ? 'bg-gradient-to-r from-cyan-500 to-teal-500 border-transparent' : 'border-white/20'}">
                        ${kind.in_ausbildung ? `<svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['check']}</svg>` : ''}
                      </div>
                      <span class="text-sm text-white/90">In Ausbildung (ab 18)</span>
                    </label>
                  </div>
                </div>
              `).join('')}
            </div>
            
            <button onclick="addKind()"
              class="w-full py-4 rounded-xl border-2 border-dashed border-pink-500/30 text-pink-300 
                     hover:border-pink-500/50 hover:bg-pink-500/10 transition-all flex items-center justify-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['plus']}</svg>
              Kind hinzufügen
            </button>
            
            ${profil.kinder.length === 0 ? `
              <div class="mt-6 p-4 rounded-xl bg-white/5 border border-white/10">
                <p class="text-sm text-white/50 flex items-start gap-2">
                  <svg class="w-5 h-5 shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['info']}</svg>
                  <span>Fügen Sie hier alle Kinder hinzu, für die Sie Kindergeld oder Kinderzuschlag beantragen möchten. Die Steuer-ID jedes Kindes ist seit 2016 Pflicht!</span>
                </p>
              </div>
            ` : ''}
          `;
          
        case 'vermoegen':
          return `
            <div class="p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/20 mb-6">
              <p class="text-sm text-yellow-300 flex items-start gap-2">
                <svg class="w-5 h-5 shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['info']}</svg>
                <span><strong>Vermögensgrenzen:</strong> Wohngeld: 60.000€ + 30.000€/Person | Bürgergeld: 15.000€/Person (nach Karenzzeit)</span>
              </p>
            </div>
            
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
              ${inputField('vermoegen', 'bargeld', 'Bargeld (€)', 'number')}
              ${inputField('vermoegen', 'girokonto_guthaben', 'Girokonto (€)', 'number')}
              ${inputField('vermoegen', 'sparkonto_guthaben', 'Sparguthaben (€)', 'number')}
              ${inputField('vermoegen', 'aktien_wert', 'Aktien/Fonds (€)', 'number')}
              ${inputField('vermoegen', 'lebensversicherung_rueckkaufwert', 'Lebensversicherung (€)', 'number', {helper: 'Rückkaufwert'})}
              ${inputField('vermoegen', 'fahrzeug_1_typ', 'Fahrzeug', 'text', {placeholder: 'z.B. VW Golf'})}
              ${inputField('vermoegen', 'fahrzeug_1_wert', 'Fahrzeugwert (€)', 'number')}
              ${inputField('vermoegen', 'schulden_gesamt', 'Schulden gesamt (€)', 'number')}
            </div>
          `;
          
        case 'besonderes':
          return `
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="p-5 rounded-xl bg-white/5 border border-white/10 space-y-4">
                <h4 class="text-sm font-semibold text-white/80">Behinderung & Pflege</h4>
                ${checkboxField('besonderes', 'schwerbehindert', 'Schwerbehindert', {helper: 'Mehrbedarf bei Merkzeichen G oder aG'})}
                ${profil.besonderes.schwerbehindert ? `
                  <div class="ml-8">${inputField('besonderes', 'grad_behinderung', 'Grad der Behinderung', 'number', {placeholder: 'z.B. 50'})}</div>
                ` : ''}
                ${selectField('besonderes', 'pflegegrad', 'Pflegegrad', [
                  {value: '', label: 'Keiner'}, {value: '1', label: 'Pflegegrad 1'},
                  {value: '2', label: 'Pflegegrad 2'}, {value: '3', label: 'Pflegegrad 3'},
                  {value: '4', label: 'Pflegegrad 4'}, {value: '5', label: 'Pflegegrad 5'}
                ])}
              </div>
              
              <div class="p-5 rounded-xl bg-white/5 border border-white/10 space-y-4">
                <h4 class="text-sm font-semibold text-white/80">Familie & Schwangerschaft</h4>
                ${checkboxField('besonderes', 'alleinerziehend', 'Alleinerziehend', {helper: 'Steuerklasse II & Mehrbedarf 36%'})}
                ${checkboxField('besonderes', 'schwangerschaft', 'Schwangerschaft', {helper: 'Mehrbedarf ab 13. SSW (17%)'})}
                ${profil.besonderes.schwangerschaft ? `
                  <div class="ml-8">${inputField('besonderes', 'schwangerschaft_et', 'Errechneter Termin', 'date')}</div>
                ` : ''}
              </div>
            </div>
          `;
          
        case 'bildung':
          return `
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              ${selectField('bildung', 'hoechster_schulabschluss', 'Höchster Schulabschluss', [
                {value: 'kein', label: 'Kein Abschluss'}, {value: 'haupt', label: 'Hauptschulabschluss'},
                {value: 'real', label: 'Mittlere Reife / Realschule'}, {value: 'fh', label: 'Fachhochschulreife'},
                {value: 'abi', label: 'Abitur / Hochschulreife'}
              ])}
              ${inputField('bildung', 'berufsausbildung', 'Berufsausbildung', 'text', {placeholder: 'z.B. Kaufmann/-frau für Büromanagement'})}
              ${inputField('bildung', 'studium', 'Studium', 'text', {placeholder: 'z.B. BWL, Informatik, Maschinenbau'})}
              ${inputField('bildung', 'fuehrerschein_klassen', 'Führerscheinklassen', 'text', {placeholder: 'z.B. B, BE, A1'})}
              <div class="sm:col-span-2">
                ${inputField('bildung', 'sprachkenntnisse', 'Sprachkenntnisse', 'text', {placeholder: 'z.B. Deutsch (Muttersprache), Englisch (B2), Spanisch (A2)'})}
              </div>
            </div>
          `;
          
        case 'einwilligungen':
          return `
            <div class="p-5 rounded-xl bg-slate-800 border border-white/10 mb-6">
              <div class="flex items-start gap-4">
                <div class="w-14 h-14 rounded-xl bg-gradient-to-r from-cyan-500 to-teal-500 flex items-center justify-center shrink-0">
                  <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['shield']}</svg>
                </div>
                <div>
                  <h4 class="font-semibold text-white mb-2">Datenschutz nach EU-Standards</h4>
                  <ul class="text-sm text-white/70 space-y-1">
                    <li>✓ AES-256 Verschlüsselung aller Daten</li>
                    <li>✓ Server ausschließlich in Deutschland</li>
                    <li>✓ EU AI Act konform - Transparenz bei KI-Nutzung</li>
                    <li>✓ Löschung Ihrer Daten jederzeit möglich</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="space-y-4">
              <div class="p-5 rounded-xl border transition-all ${profil.einwilligungen.dsgvo_einwilligung 
                ? 'bg-emerald-500/10 border-emerald-500/30' : 'bg-white/5 border-white/10'}">
                ${checkboxField('einwilligungen', 'dsgvo_einwilligung', 'Einwilligung zur Datenverarbeitung (DSGVO Art. 6) *', 
                  {helper: 'Ich willige ein, dass meine Daten zur Antragsbearbeitung gespeichert und verarbeitet werden. Diese Einwilligung kann jederzeit widerrufen werden.'})}
              </div>
              
              <div class="p-5 rounded-xl border transition-all ${profil.einwilligungen.ki_verarbeitung_einwilligung 
                ? 'bg-cyan-500/10 border-cyan-500/30' : 'bg-white/5 border-white/10'}">
                ${checkboxField('einwilligungen', 'ki_verarbeitung_einwilligung', 'Einwilligung zur KI-gestützten Verarbeitung (EU AI Act)', 
                  {helper: 'Ich willige ein, dass eine KI meine Daten analysiert, um passende Förderungen zu finden und Anträge automatisch auszufüllen. Die finale Prüfung erfolgt stets durch mich.'})}
              </div>
              
              <div class="p-5 rounded-xl border transition-all ${profil.einwilligungen.datenweitergabe_behoerden 
                ? 'bg-purple-500/10 border-purple-500/30' : 'bg-white/5 border-white/10'}">
                ${checkboxField('einwilligungen', 'datenweitergabe_behoerden', 'Datenübermittlung an Behörden', 
                  {helper: 'Ich willige ein, dass meine Daten an zuständige Behörden (Jobcenter, Familienkasse, Wohngeldamt etc.) übermittelt werden dürfen.'})}
              </div>
            </div>
          `;
          
        default:
          return '<p class="text-white/50">Sektion nicht gefunden</p>';
      }
    }
    
    // ═══════════════════════════════════════════════════════════════════════════
    // KINDER FUNCTIONS
    // ═══════════════════════════════════════════════════════════════════════════
    
    function addKind() {
      profil.kinder.push({
        id: Date.now(),
        vorname: '',
        nachname: '',
        geburtsdatum: '',
        steuer_id: '',
        lebt_im_haushalt: true,
        in_ausbildung: false
      });
      renderContent();
    }
    
    function updateKind(index, field, value) {
      profil.kinder[index][field] = value;
    }
    
    function toggleKindCheckbox(index, field) {
      profil.kinder[index][field] = !profil.kinder[index][field];
      renderContent();
    }
    
    function removeKind(index) {
      profil.kinder.splice(index, 1);
      renderContent();
    }
    
    // ═══════════════════════════════════════════════════════════════════════════
    // PROGRESS & SAVE
    // ═══════════════════════════════════════════════════════════════════════════
    
    function updateProgress() {
      const requiredFields = [
        profil.persoenlich.vorname,
        profil.persoenlich.nachname,
        profil.persoenlich.geburtsdatum,
        profil.persoenlich.steuer_id,
        profil.kontakt.strasse,
        profil.kontakt.plz,
        profil.kontakt.ort,
        profil.bank.iban,
        profil.krankenversicherung.krankenkasse_name,
        profil.wohnung.wohnverhaeltnis,
        profil.einkommen.beschaeftigungsart
      ];
      
      const filled = requiredFields.filter(f => f && f.toString().trim() !== '').length;
      const percentage = Math.round((filled / requiredFields.length) * 100);
      
      document.getElementById('progress-text').textContent = percentage + '%';
      document.getElementById('progress-bar').style.width = percentage + '%';
    }
    
    function updateSaveButton() {
      const btn = document.getElementById('save-btn');
      btn.disabled = !profil.einwilligungen.dsgvo_einwilligung;
    }
    
    function handleSave() {
      const btn = document.getElementById('save-btn');
      const text = document.getElementById('save-text');
      
      text.textContent = 'Speichern...';
      btn.disabled = true;
      
      setTimeout(() => {
        text.innerHTML = `<svg class="w-5 h-5 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons['check']}</svg> Gespeichert!`;
        btn.classList.add('from-emerald-500', 'to-green-500');
        btn.classList.remove('from-cyan-500', 'to-teal-500');
        
        setTimeout(() => {
          text.textContent = 'Speichern';
          btn.classList.remove('from-emerald-500', 'to-green-500');
          btn.classList.add('from-cyan-500', 'to-teal-500');
          btn.disabled = !profil.einwilligungen.dsgvo_einwilligung;
        }, 3000);
      }, 1500);
    }
    
    // ═══════════════════════════════════════════════════════════════════════════
    // INIT
    // ═══════════════════════════════════════════════════════════════════════════
    
    document.addEventListener('DOMContentLoaded', () => {
      renderNav();
      renderContent();
      updateHeader();
      updateProgress();
      updateSaveButton();
    });
  </script>
</body>
</html>
